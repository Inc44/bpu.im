{% extends "base.html" %}{% block title %}{{ article.title }} - bpu.im{% endblock %}{% block content %}<div class="gap-8 grid lg:grid-cols-4">
	<aside class="lg:col-span-1">{% include 'components/nav.html' %}</aside>
	<div class="lg:col-span-3">
		<h1 class="font-bold mb-6 text-3xl">{{ article.title }}</h1>
		<div>{{ article.content|safe }}</div>{% set quiz = article.get_quiz() %}{% if quiz and quiz|length>0 %}<section class="border border-green-400 mt-8 p-8">
			<h2 class="font-bold mb-4 text-2xl">Quiz</h2>
			<form hx-post="/quiz/{{ article.slug }}" hx-target="#quiz-result" hx-swap="innerHTML" class="space-y-6">{% for q in quiz %}{% set i=loop.index %}<div>
					<p class="font-semibold mb-2">Q{{ i }}. {{ q.prompt }}</p>{% if q.type=='single' %}<div class="space-y-1">{% for opt in q.options %}{% set j=loop.index0 %}<label class="flex gap-2"><input type="radio" name="q{{ i }}" value="{{ j }}" class="accent-green-400"><span>{{ opt }}</span></label>{% endfor %}</div>{% elif q.type=='multi' %}<div class="space-y-1">{% for opt in q.options %}{% set j=loop.index0 %}<label class="flex gap-2"><input type="checkbox" name="q{{ i }}_{{ j }}" class="accent-green-400"><span>{{ opt }}</span></label>{% endfor %}</div>{% elif q.type=='text' %}<input type="text" name="q{{ i }}" class="bg-black border border-green-400 px-2 py-1 text-green-400 w-full">{% endif %}
				</div>{% endfor %}<button type="submit" class="border border-green-400 hover:bg-green-400 hover:text-black px-4 py-2">Submit</button>
			</form>
			<div id="quiz-result"></div>
		</section>{% endif %}<div id="read-sentinel"></div>
	</div>
</div>
<script>
	(function()
	{
		var read_sentinel = document.getElementById('read-sentinel');
		if (!read_sentinel)
		{
			return
		}
		var sent = false;
		var obs = new IntersectionObserver(function(entries)
		{
			if (entries[0].isIntersecting && !sent)
			{
				sent = true;
				fetch('/mark_read/{{ article.slug }}',
				{
					method: 'POST',
					credentials: 'include'
				});
			}
		});
		obs.observe(read_sentinel);
	})();
</script>{% endblock %}